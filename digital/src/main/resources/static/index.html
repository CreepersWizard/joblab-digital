<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joblab - Modulo Digital</title>
    <link rel="stylesheet" href="./css/main.css">
</head>

<body>      
    <div id="navbar">
        <a href="#home">Home</a>
        <a href="#news">News</a>
        <a href="#contact">Contact</a>
        <a href="#about">About</a>
      </div>
      
    <p>cliccate sui pulsanti sotto per vedere i dati restituiti dal back-end</p>

    <div id="btnCars" >
        Auto in vendita
        <code id="resultCars"></code>
        
    </div>

    <div id="btnClothes">
        Vestiti in vendita
        <code id="resultClothes"></code>
        
    </div>

    <div id="btnTechs">
        Gadget in vendita
        <code id="resultTechs">
        
    </div>

    <p>sotto invece alcuni suggerimenti su come creare</p>
    <details>
        <summary>una barra di navigazione</summary>
        <p><a href="https://www.w3schools.com/howto/howto_js_topnav.asp"> Superiore (Top Navigation)</a></p>
        <p><a href="https://www.w3schools.com/howto/howto_js_sidenav.asp"> laterale (Side Navigation)</a></p>
    </details>
    <details>
        <summary>una tabella</summary>
        <p><a href="https://www.w3schools.com/tags/tag_table.asp"> Tabella Semplice</a></p>
        <p><a href="https://www.w3schools.com/tags/tag_tbody.asp"> Con distinzione di stili e comportamenti per Header,
                Body e Footer </a></p>
    </details>
    <details>
        <summary>una dialog di dettagli</summary>
        <p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog">Riferimento MDN</a></p>
    </details>
    <script type="module">
        import fetch from './js/fetch.js';

        /***
         * Funzione che riporta l'output di un servizio formattato in un code Element
         * @Parameters:
         * f: la funzione che restituisce l'output json del servizio
         * idCode: l'id dell'elemento in cui incollare il contenuto
         */
        async function showDataInCode(f, idCode) {
            const codeElement = document.getElementById(idCode);
            const data = await f();
            data.forEach(element => {
                var div1 = document.createElement('div');
                div1.className = "flex-container";
                div1.style = {
                                display: "flex",
                                flexWrap: "nowrap",
                                backgroundColor: "#32CD32"
                            };
                var div = document.createElement('div');
                div.style = {
                                backgroundColor: "#98FB98",
                                width: "150px",
                                textAlign: "center",
                                lineHeight: "150px",
                                
                            };
                div1.appendChild(div);
                var h3 = document.createElement('div');
                h3.textContent = element.name;
                div.appendChild(h3);
                var img = document.createElement('img');
                img.src = element.image;
                img.width = 250;
                img.height = 250;
                div.appendChild(img);
                var h1 = document.createElement('div');
                h1.textContent = "Price: €"+element.price;
                div.appendChild(h1);
                var button = document.createElement('button');
                button.textContent = "Details";
                div.appendChild(button);

                codeElement.appendChild(div1);
            });
            
            
            
        }

        /***
         * Funzione che aggiunge all'evento di apertura la chiamata al servizio del back-end
         * @Parameters:
         * type => il tipo di output da visualizzare, è il riferimento per:
         *  * la funzione (getXXXX)
         *  * l'elemento details (btnXXXX) a cui agganciare l'evento
         *  * l'elemento code (resultXXXX) in cui incollare il risultato
         */
        async function addToggleEventToDetail(type) {
            const detailElement = document.getElementById(`btn${type}`);
            showDataInCode(fetch[`get${type}`], `result${type}`)
        }

        //Applico la logica di chiamata ed esposizione per tutti i 3 tipi di servizio che ho a disposizione
        ["Cars", "Techs", "Clothes"].forEach(type => addToggleEventToDetail(type));
    </script>
</body>
  
  
</html>